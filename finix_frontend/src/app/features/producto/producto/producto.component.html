<div class="p-4 sm:p-8 bg-gray-50 min-h-screen">
    <mat-toolbar class="bg-white shadow-md rounded-lg mb-6">
        <h1 class="text-2xl font-bold text-gray-800 flex-auto" >Administrar Productos</h1>
        
        <app-custom-button color="primary" (buttonClick)="abrirDialogoProducto()" [disabled]="isLoading()">
            <mat-icon>add</mat-icon>
            <span>Crear Producto</span>
        </app-custom-button>
    </mat-toolbar>

    <mat-card class="mb-6 p-4">
        <mat-form-field appearance="fill" class="w-full">
            <mat-label>Filtrar Productos por Nombre, Proveedor o Precio</mat-label>
            <input matInput (keyup)="applyFilter($event)" placeholder="Buscar..." #input>
            <mat-icon matPrefix>search</mat-icon>
        </mat-form-field>
    </mat-card>
    <div class="mat-elevation-z4 overflow-hidden rounded-lg bg-white">
        <table mat-table [dataSource]="dataSource" class="w-full"> 

            <ng-container matColumnDef="nombre">
                <th mat-header-cell *matHeaderCellDef class="text-sm font-semibold text-gray-600 bg-gray-100"> Nombre </th>
                <td mat-cell *matCellDef="let prod" class="text-gray-800"> {{prod.nombre}} </td>
            </ng-container>

            <ng-container matColumnDef="precioVenta">
                <th mat-header-cell *matHeaderCellDef class="text-sm font-semibold text-gray-600 bg-gray-100"> Precio Venta </th>
                <td mat-cell *matCellDef="let prod" class="text-gray-800"> {{prod.precioVenta | currency:'COP':'symbol':'1.0-0'}} </td>
            </ng-container>

            <ng-container matColumnDef="precioCompra">
                <th mat-header-cell *matHeaderCellDef class="text-sm font-semibold text-gray-600 bg-gray-100"> Precio Compra </th>
                <td mat-cell *matCellDef="let prod" class="text-gray-800"> {{prod.precioCompra | currency:'COP':'symbol':'1.0-0'}} </td>
            </ng-container>

            <ng-container matColumnDef="stock">
                <th mat-header-cell *matHeaderCellDef class="text-sm font-semibold text-gray-600 bg-gray-100"> Stock </th>
                <td mat-cell *matCellDef="let prod" class="text-gray-800"> {{prod.stock}} </td>
            </ng-container>

            <ng-container matColumnDef="proveedor">
                <th mat-header-cell *matHeaderCellDef class="text-sm font-semibold text-gray-600 bg-gray-100"> Proveedor </th>
                <td mat-cell *matCellDef="let prod"> {{ prod.proveedor?.nombre || 'N/A' }} </td>
            </ng-container>

            <ng-container matColumnDef="acciones">
                <th mat-header-cell *matHeaderCellDef class="text-right text-sm font-semibold text-gray-600 bg-gray-100"> Acciones </th>
                <td mat-cell *matCellDef="let prod" class="text-right">
                    <button mat-icon-button color="primary" (click)="abrirDialogoProducto(prod)" matTooltip="Editar producto">
                        <mat-icon>edit</mat-icon>
                    </button>
                    <button mat-icon-button color="warn" (click)="eliminarProducto(prod.id)" matTooltip="Eliminar producto">
                        <mat-icon>delete</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="hover:bg-gray-50 transition-colors duration-200"></tr>

             @if (!dataSource.data.length && !isLoading()) {
                <tr class="mat-row">
                    <td class="mat-cell text-center p-6 text-gray-500" [attr.colspan]="displayedColumns.length">
                        No hay productos que coincidan con el filtro.
                    </td>
                </tr>
            }
        </table>
        
        <mat-paginator 
            [pageSizeOptions]="[10, 50, 100]" 
            showFirstLastButtons 
            aria-label="Selecciona pÃ¡gina de productos"
            [pageSize]="10">
        </mat-paginator>
        </div>
</div>